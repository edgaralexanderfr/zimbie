var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("AssetManager",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.loadMap=function(e){e.load.json("assets","assets/assets.json")},e.load=function(e){var t,i=e.cache.getJSON("assets"),r=i.single,a=i.multiple;for(t=0;t<r.length;t++){var n=r[t];this.loadFile(i,e,n.type,n.name,n.uri,n)}for(t=0;t<a.length;t++){n=a[t];var s=void 0;for(s=1;s<=n.total;s++){var o=n.name+s,d=n.uri+s+n.extension;this.loadFile(i,e,n.type,o,d,n)}}e.load.start()},e.loadFile=function(e,t,i,r,a,n){switch(i){case"image":t.load.image(r,a);break;case"json":t.load.json(r,a);break;case"spritesheet":var s=e.spritesheets.spriteWidth,o=e.spritesheets.spriteHeight,d=void 0;n.spriteWidth&&(s=n.spriteWidth),n.spriteHeight&&(s=n.spriteHeight),n.spriteMax&&(d=n.spriteMax),t.load.spritesheet(r,a,s,o,d)}},e}();t.default=i}),define("Character",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),this._sprites={},this._lastAnimationPlayed="",this._game=e,this._body=this._game.add.sprite(t,i,"sprite-character-body"),this.create(t,i)}return Object.defineProperty(e.prototype,"game",{get:function(){return this._game},set:function(e){this._game=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},enumerable:!0,configurable:!0}),e.prototype.setClothing=function(e,t){var i=this._sprites[e],r=i.spriteArray[i.selectedSprite],a=i.spriteArray[t];i.selectedSprite=t,r&&r.sprite&&(r.sprite.visible=!1),a&&a.sprite&&(a.sprite.tint=a.color,a.sprite.visible=!0);var n=this._lastAnimationPlayed;this._lastAnimationPlayed="",this.playAnimation(n)},e.prototype.previousClothing=function(e){var t=this._sprites[e],i=t.selectedSprite-1;i<0&&(i=t.spriteArray.length-1),this.setClothing(e,i)},e.prototype.nextClothing=function(e){var t=this._sprites[e],i=t.selectedSprite+1;i>=t.spriteArray.length&&(i=0),this.setClothing(e,i)},e.prototype.setClothingColor=function(e,t){void 0===t&&(t=16777215);var i=this._sprites[e],r=i.spriteArray[i.selectedSprite];r&&(r.color=t,r.sprite&&(r.sprite.tint=t))},e.prototype.playAnimation=function(e){if(e!=this._lastAnimationPlayed)for(var t in this._lastAnimationPlayed=e,this._sprites){var i=this._sprites[t],r=i.spriteArray[i.selectedSprite];r&&r.sprite&&(r.sprite.animations.stop(),r.sprite.animations.play(e))}},e.prototype.create=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var i=this.game.cache.getJSON("data-game");this._body.anchor.set(.5,.5),this.addAnimation(i,this._body);var r={spriteArray:[{sprite:this._body,color:16777215}],selectedSprite:0};this._sprites.body=r;for(var a=0,n=i.character.clothing;a<n.length;a++){var s=n[a];if(s.single){(l=this._game.make.sprite(0,0,"sprite-character-"+s.name)).anchor.set(.5,.5),this.addAnimation(i,l),this._body.addChild(l);var o={spriteArray:[{sprite:l,color:16777215}],selectedSprite:0};this._sprites[s.name]=o}else{for(var d=[null],h=1;h<=s.total;h++){var l;(l=this._game.make.sprite(0,0,"sprite-character-"+s.name+h)).anchor.set(.5,.5),l.visible=!1,this.addAnimation(i,l),this._body.addChild(l);var p={sprite:l,color:16777215};d.push(p)}var g={spriteArray:d,selectedSprite:0};this._sprites[s.name]=g}}},e.prototype.addAnimation=function(e,t){for(var i=0,r=0,a=e.character.sprites.animations;r<a.length;r++)for(var n=a[r],s=0,o=e.character.sprites.directions;s<o.length;s++){for(var d=o[s],h=[],l=0;l<e.character.sprites.totalFrames;l++)h.push(i),i++;t.animations.add(n.name+d,h,n.frameRate,n.loop)}},e}();t.default=i}),define("Terrain",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._game=e}return Object.defineProperty(e.prototype,"game",{get:function(){return this._game},set:function(e){this._game=e},enumerable:!0,configurable:!0}),e.prototype.generate=function(){var e,t,i=this.game.cache.getJSON("data-game"),r=[];for(e=0;e<i.terrain.height;e++)for(r[e]=[],t=0;t<i.terrain.width;t++)r[e][t]="";for(var a=i.terrain.width*i.terrain.height,n=0,s=i.terrain.population;n<s.length;n++){var o=s[n],d=Math.floor(a*o.seed);do{var h=this.game.rnd.integerInRange(0,i.terrain.width-1);r[v=this.game.rnd.integerInRange(0,i.terrain.height-1)][h]=o.name,d--}while(0<d)}var l=Math.floor(a*i.terrain.dirt.seed),p=i.terrain.dirt.minWidth*i.terrain.dirt.minHeight,g=l;do{var c=this.game.rnd.integerInRange(i.terrain.dirt.minWidth,i.terrain.dirt.maxWidth),m=this.game.rnd.integerInRange(i.terrain.dirt.minHeight,i.terrain.dirt.maxHeight);h=this.game.rnd.integerInRange(0,i.terrain.width-c);for(e=v=this.game.rnd.integerInRange(0,i.terrain.height-m);e<v+m;e++)for(t=h;t<h+c;t++)"dirt"!=r[e][t]&&(r[e][t]="dirt",g--)}while(p<=g);var u=i.terrain.tileSize*i.terrain.width,f=i.terrain.tileSize*i.terrain.height,y=this.game.add.bitmapData(u,f);for(e=0;e<i.terrain.height;e++)for(t=0;t<i.terrain.width;t++){h=t*i.terrain.tileSize;var v=e*i.terrain.tileSize;switch(r[e][t]){case"dirt":var b=this.getNeighbors(r,t,e,"dirt");"dirt"!=b[3]&&"dirt"!=b[1]?y.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[1]),h,v):"dirt"!=b[5]&&"dirt"!=b[1]?y.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[2]),h,v):"dirt"!=b[3]&&"dirt"!=b[7]?y.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[3]),h,v):"dirt"!=b[5]&&"dirt"!=b[7]?y.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[4]),h,v):y.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[0]),h,v);break;case"grass1":y.context.drawImage(this.game.cache.getImage(i.terrain.population[0].asset),h,v);break;case"rocks1":y.context.drawImage(this.game.cache.getImage(i.terrain.population[1].asset),h,v);break;case"grass2":y.context.drawImage(this.game.cache.getImage(i.terrain.population[2].asset),h,v);break;case"sticks1":y.context.drawImage(this.game.cache.getImage(i.terrain.population[3].asset),h,v);break;default:y.context.drawImage(this.game.cache.getImage(i.terrain.asset),h,v)}}this.game.world.setBounds(0,0,u,f),this.game.cache.addBitmapData("terrain",y),this.game.add.sprite(0,0,this.game.cache.getBitmapData("terrain"))},e.prototype.getNeighbors=function(e,t,i,r){void 0===r&&(r="");var a,n,s=[r,r,r,r,r,r,r,r,r],o=0;for(n=i-1;n<=i+1;n++)for(a=t-1;a<=t+1;a++)void 0!==e[n]&&void 0!==e[n][a]&&(s[o]=e[n][a]),o++;return s},e}();t.default=i}),define("main",["require","exports","AssetManager","Terrain","Character"],function(e,t,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i),r=__importDefault(r),a=__importDefault(a);var n,s,o,d,h,l,p,g,c,m,u,f=new Phaser.Game(1350,650,Phaser.AUTO,"",{preload:function(){document.body.style.backgroundColor="black",i.default.loadMap(f)},create:function(){f.load.onLoadComplete.add(y),i.default.load(f),n=f.input.keyboard.addKey(Phaser.Keyboard.UP),s=f.input.keyboard.addKey(Phaser.Keyboard.DOWN),o=f.input.keyboard.addKey(Phaser.Keyboard.LEFT),d=f.input.keyboard.addKey(Phaser.Keyboard.RIGHT),h=f.input.keyboard.addKey(Phaser.Keyboard.ZERO),l=f.input.keyboard.addKey(Phaser.Keyboard.ONE),p=f.input.keyboard.addKey(Phaser.Keyboard.TWO),g=f.input.keyboard.addKey(Phaser.Keyboard.THREE),c=f.input.keyboard.addKey(Phaser.Keyboard.FOUR),m=f.input.keyboard.addKey(Phaser.Keyboard.FIVE)},update:function(){n.isDown&&(u.body.y-=4);s.isDown&&(u.body.y+=4);o.isDown&&(u.body.x-=4);d.isDown&&(u.body.x+=4);if(h.isDown){var e=prompt("Clothing name:"),t=prompt("Clothing colour:");u.setClothingColor(e,+t)}l.isDown&&u.nextClothing("hair");p.isDown&&u.nextClothing("jacket");g.isDown&&u.nextClothing("shirt");c.isDown&&u.nextClothing("pants");m.isDown&&u.nextClothing("shoes");if(n.isDown&&o.isDown)return void u.playAnimation("walkUpLeft");if(n.isDown&&d.isDown)return void u.playAnimation("walkUpRight");if(s.isDown&&o.isDown)return void u.playAnimation("walkDownLeft");if(s.isDown&&d.isDown)return void u.playAnimation("walkDownRight");if(n.isDown)return void u.playAnimation("walkUp");if(s.isDown)return void u.playAnimation("walkDown");if(o.isDown)return void u.playAnimation("walkLeft");if(d.isDown)return void u.playAnimation("walkRight")}});function y(){new r.default(f).generate(),(u=new a.default(f,675,325)).setClothing("hair",1),u.setClothing("jacket",1),u.setClothing("shirt",1),u.setClothing("pants",1),u.setClothing("shoes",1),f.camera.follow(u.body,Phaser.Camera.FOLLOW_LOCKON)}}),define("util/damage",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(t.util||(t.util={})).damage=function(e,t){return e*(1-t)}});