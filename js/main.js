var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("AssetManager",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.loadMap=function(e){e.load.json("assets","assets/assets.json")},e.load=function(e){var t,i=e.cache.getJSON("assets"),a=i.single,r=i.multiple;for(t=0;t<a.length;t++){var n=a[t];this.loadFile(i,e,n.type,n.name,n.uri,n)}for(t=0;t<r.length;t++){n=r[t];var o=void 0;for(o=1;o<=n.total;o++){var s=n.name+o,d=n.uri+o+n.extension;this.loadFile(i,e,n.type,s,d,n)}}e.load.start()},e.loadFile=function(e,t,i,a,r,n){switch(i){case"image":t.load.image(a,r);break;case"json":t.load.json(a,r);break;case"spritesheet":var o=e.spritesheets.spriteWidth,s=e.spritesheets.spriteHeight,d=void 0;n.spriteWidth&&(o=n.spriteWidth),n.spriteHeight&&(o=n.spriteHeight),n.spriteMax&&(d=n.spriteMax),t.load.spritesheet(a,r,o,s,d)}},e}();t.default=i}),define("Character",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,a,r){void 0===a&&(a=0),void 0===r&&(r=0),this._sprites={},this._lastAnimationPlayed="",this._game=e,this._shadowsGroup=t,this._charactersGroup=i,this._shadow=this._game.make.sprite(a,r,"sprite-shadow"),this._body=this._game.make.sprite(a,r,"sprite-character-body"),this.create(a,r)}return Object.defineProperty(e.prototype,"game",{get:function(){return this._game},set:function(e){this._game=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsGroup",{get:function(){return this._shadowsGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"charactersGroup",{get:function(){return this._charactersGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this._shadow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},enumerable:!0,configurable:!0}),e.prototype.setClothing=function(e,t){var i=this._sprites[e],a=i.spriteArray[i.selectedSprite],r=i.spriteArray[t];i.selectedSprite=t,a&&a.sprite&&(a.sprite.visible=!1),r&&r.sprite&&(r.sprite.tint=r.color,r.sprite.visible=!0);var n=this._lastAnimationPlayed;this._lastAnimationPlayed="",this.playAnimation(n)},e.prototype.previousClothing=function(e){var t=this._sprites[e],i=t.selectedSprite-1;i<0&&(i=t.spriteArray.length-1),this.setClothing(e,i)},e.prototype.nextClothing=function(e){var t=this._sprites[e],i=t.selectedSprite+1;i>=t.spriteArray.length&&(i=0),this.setClothing(e,i)},e.prototype.setClothingColor=function(e,t){void 0===t&&(t=16777215);var i=this._sprites[e],a=i.spriteArray[i.selectedSprite];a&&(a.color=t,a.sprite&&(a.sprite.tint=t))},e.prototype.playAnimation=function(e){if(e!=this._lastAnimationPlayed)for(var t in this._lastAnimationPlayed=e,this._sprites){var i=this._sprites[t],a=i.spriteArray[i.selectedSprite];a&&a.sprite&&(a.sprite.animations.stop(),a.sprite.animations.play(e))}},e.prototype.update=function(){this._shadow.x=this._body.x,this._shadow.y=this._body.y},e.prototype.create=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var i=this.game.cache.getJSON("data-game");this._shadow.anchor.set(.5,.5),this._body.anchor.set(.5,.5),this.addAnimation(i,this._body),this._shadowsGroup.add(this._shadow),this._charactersGroup.add(this._body);var a={spriteArray:[{sprite:this._body,color:16777215}],selectedSprite:0};this._sprites.body=a;for(var r=0,n=i.character.clothing;r<n.length;r++){var o=n[r];if(o.single){(p=this._game.make.sprite(0,0,"sprite-character-"+o.name)).anchor.set(.5,.5),this.addAnimation(i,p),this._body.addChild(p);var s={spriteArray:[{sprite:p,color:16777215}],selectedSprite:0};this._sprites[o.name]=s}else{for(var d=[null],h=1;h<=o.total;h++){var p;(p=this._game.make.sprite(0,0,"sprite-character-"+o.name+h)).anchor.set(.5,.5),p.visible=!1,this.addAnimation(i,p),this._body.addChild(p);var l={sprite:p,color:16777215};d.push(l)}var c={spriteArray:d,selectedSprite:0};this._sprites[o.name]=c}}},e.prototype.addAnimation=function(e,t){for(var i=0,a=0,r=e.character.sprites.animations;a<r.length;a++)for(var n=r[a],o=0,s=e.character.sprites.directions;o<s.length;o++){for(var d=s[o],h=[],p=0;p<e.character.sprites.totalFrames;p++)h.push(i),i++;t.animations.add(n.name+d,h,n.frameRate,n.loop)}},e}();t.default=i}),define("Terrain",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._game=e}return Object.defineProperty(e.prototype,"game",{get:function(){return this._game},set:function(e){this._game=e},enumerable:!0,configurable:!0}),e.prototype.generate=function(){var e,t,i=this.game.cache.getJSON("data-game"),a=[];for(e=0;e<i.terrain.height;e++)for(a[e]=[],t=0;t<i.terrain.width;t++)a[e][t]="";for(var r=i.terrain.width*i.terrain.height,n=0,o=i.terrain.population;n<o.length;n++){var s=o[n],d=Math.floor(r*s.seed);do{var h=this.game.rnd.integerInRange(0,i.terrain.width-1);a[w=this.game.rnd.integerInRange(0,i.terrain.height-1)][h]=s.name,d--}while(0<d)}var p=Math.floor(r*i.terrain.dirt.seed),l=i.terrain.dirt.minWidth*i.terrain.dirt.minHeight,c=p;do{var g=this.game.rnd.integerInRange(i.terrain.dirt.minWidth,i.terrain.dirt.maxWidth),u=this.game.rnd.integerInRange(i.terrain.dirt.minHeight,i.terrain.dirt.maxHeight);h=this.game.rnd.integerInRange(0,i.terrain.width-g);for(e=w=this.game.rnd.integerInRange(0,i.terrain.height-u);e<w+u;e++)for(t=h;t<h+g;t++)"dirt"!=a[e][t]&&(a[e][t]="dirt",c--)}while(l<=c);var m=i.terrain.tileSize*i.terrain.width,y=i.terrain.tileSize*i.terrain.height,f=this.game.add.bitmapData(m,y);for(e=0;e<i.terrain.height;e++)for(t=0;t<i.terrain.width;t++){h=t*i.terrain.tileSize;var w=e*i.terrain.tileSize;switch(a[e][t]){case"dirt":var b=this.getNeighbors(a,t,e,"dirt");"dirt"!=b[3]&&"dirt"!=b[1]?f.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[1]),h,w):"dirt"!=b[5]&&"dirt"!=b[1]?f.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[2]),h,w):"dirt"!=b[3]&&"dirt"!=b[7]?f.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[3]),h,w):"dirt"!=b[5]&&"dirt"!=b[7]?f.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[4]),h,w):f.context.drawImage(this.game.cache.getImage(i.terrain.dirt.assets[0]),h,w);break;case"grass1":f.context.drawImage(this.game.cache.getImage(i.terrain.population[0].asset),h,w);break;case"rocks1":f.context.drawImage(this.game.cache.getImage(i.terrain.population[1].asset),h,w);break;case"grass2":f.context.drawImage(this.game.cache.getImage(i.terrain.population[2].asset),h,w);break;case"sticks1":f.context.drawImage(this.game.cache.getImage(i.terrain.population[3].asset),h,w);break;default:f.context.drawImage(this.game.cache.getImage(i.terrain.asset),h,w)}}this.game.world.setBounds(0,0,m,y),this.game.cache.addBitmapData("terrain",f),this.game.add.tileSprite(0,0,m,y,this.game.cache.getBitmapData("terrain"))},e.prototype.getNeighbors=function(e,t,i,a){void 0===a&&(a="");var r,n,o=[a,a,a,a,a,a,a,a,a],s=0;for(n=i-1;n<=i+1;n++)for(r=t-1;r<=t+1;r++)void 0!==e[n]&&void 0!==e[n][r]&&(o[s]=e[n][r]),s++;return o},e}();t.default=i}),define("main",["require","exports","AssetManager","Terrain","Character"],function(e,t,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i),a=__importDefault(a),r=__importDefault(r);var n,o,s,d,h,p,l,c,g,u,m,y,f,w=new Phaser.Game(window.innerWidth*window.devicePixelRatio,window.innerHeight*window.devicePixelRatio,Phaser.AUTO,"",{preload:function(){i.default.loadMap(w)},create:function(){n=w.input.keyboard.addKey(Phaser.Keyboard.UP),o=w.input.keyboard.addKey(Phaser.Keyboard.DOWN),s=w.input.keyboard.addKey(Phaser.Keyboard.LEFT),d=w.input.keyboard.addKey(Phaser.Keyboard.RIGHT),h=w.input.keyboard.addKey(Phaser.Keyboard.ZERO),p=w.input.keyboard.addKey(Phaser.Keyboard.ONE),l=w.input.keyboard.addKey(Phaser.Keyboard.TWO),c=w.input.keyboard.addKey(Phaser.Keyboard.THREE),g=w.input.keyboard.addKey(Phaser.Keyboard.FOUR),u=w.input.keyboard.addKey(Phaser.Keyboard.FIVE),w.load.onLoadComplete.add(b),i.default.load(w)},update:function(){n.isDown&&(f.body.y-=4);o.isDown&&(f.body.y+=4);s.isDown&&(f.body.x-=4);d.isDown&&(f.body.x+=4);if(h.isDown){var e=prompt("Clothing name:"),t=prompt("Clothing colour:");f.setClothingColor(e,+t)}p.isDown&&f.nextClothing("hair");l.isDown&&f.nextClothing("jacket");c.isDown&&f.nextClothing("shirt");g.isDown&&f.nextClothing("pants");u.isDown&&f.nextClothing("shoes");n.isDown&&s.isDown?f.playAnimation("walkUpLeft"):n.isDown&&d.isDown?f.playAnimation("walkUpRight"):o.isDown&&s.isDown?f.playAnimation("walkDownLeft"):o.isDown&&d.isDown?f.playAnimation("walkDownRight"):n.isDown?f.playAnimation("walkUp"):o.isDown?f.playAnimation("walkDown"):s.isDown?f.playAnimation("walkLeft"):d.isDown&&f.playAnimation("walkRight");f&&f.update();m&&m.sort("y",Phaser.Group.SORT_ASCENDING);y&&y.sort("y",Phaser.Group.SORT_ASCENDING)}});function b(){new a.default(w).generate(),m=w.add.group(),y=w.add.group(),(f=new r.default(w,m,y,2048,2048)).setClothing("hair",1),f.setClothing("jacket",1),f.setClothing("shirt",1),f.setClothing("pants",1),f.setClothing("shoes",1),w.camera.follow(f.body,Phaser.Camera.FOLLOW_LOCKON)}window.addEventListener("resize",function(e){w.scale.setGameSize(window.innerWidth*window.devicePixelRatio,window.innerHeight*window.devicePixelRatio)},!1)}),define("util/damage",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(t.util||(t.util={})).damage=function(e,t){return e*(1-t)}});